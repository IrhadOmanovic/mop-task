import Head from 'next/head'
import PropTypes from 'prop-types'
import { SessionProvider } from 'next-auth/react'
import { reduxWrapper } from '@pimred/redux'
import { config } from '@fortawesome/fontawesome-svg-core'
import { io } from 'socket.io-client'
import { useRef } from 'react'

import Header from '../components/patterns/organizms/header'
import Footer from '../components/patterns/organizms/footer'
import { SocketProvider } from '../lib/contexts/socketContext'

import '@fortawesome/fontawesome-svg-core/styles.css'
config.autoAddCss = false

const App = ({
  Component,
  pageProps: { session, ...pageProps }
}) => {
  const socket = useRef(io(process.env.NEXT_PUBLIC_NOTIFICATION_SERVER_URL))
  return (
    <SessionProvider session={session}>
      <SocketProvider value={socket.current}>
        <Head>
          <title>Create Next App</title>
          <meta name='description' content='Generated by create next app' />
          <link rel='icon' href='/favicon.ico' />
          <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css' rel='stylesheet' integrity='sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC' crossOrigin='anonymous' />
          <script src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js' integrity='sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM' crossOrigin='anonymous' />
        </Head>
        <Header />
        <Component {...pageProps} />
        <Footer />
        <Head>
          <title>Mop task by Irhad Omanovic</title>
          <meta name='description' content='Generated by create next app' />
          <link rel='icon' href='/favicon.ico' />
          <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css' rel='stylesheet' integrity='sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC' crossOrigin='anonymous' />
          <script src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js' integrity='sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM' crossOrigin='anonymous' />
        </Head>
      </SocketProvider>
    </SessionProvider>
  )
}

App.propTypes = {
  Component : PropTypes.any,
  pageProps : PropTypes.object
}

export default reduxWrapper.withRedux(App)
